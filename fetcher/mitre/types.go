package mitre

import "encoding/json"

// https://github.com/MaineK00n/vuls-data-update/blob/6c082eefa485f54c210d4cd636e295408cc422bf/pkg/fetch/mitre/v5/types.go#L3-L303
type cve struct {
	DataType    string      `json:"dataType"`
	DataVersion string      `json:"dataVersion"`
	CVEMetadata cveMetadata `json:"cveMetadata"`
	Containers  struct {
		CNA cna   `json:"cna"`
		ADP []adp `json:"adp,omitempty"`
	} `json:"containers"`
}

type cveMetadata struct {
	CVEID             string  `json:"cveId"`
	AssignerOrgID     string  `json:"assignerOrgId"`
	AssignerShortName *string `json:"assignerShortName,omitempty"`
	RequesterUserID   *string `json:"requesterUserId,omitempty"`
	Serial            *int    `json:"serial,omitempty"`
	State             string  `json:"state"`
	DatePublished     *string `json:"datePublished,omitempty"`
	DateUpdated       *string `json:"dateUpdated,omitempty"`
	DateReserved      *string `json:"dateReserved,omitempty"`
	DateRejected      *string `json:"dateRejected,omitempty"`
}

type cna struct {
	ProviderMetadata providerMetadata `json:"providerMetadata"`
	Title            *string          `json:"title,omitempty"`
	Descriptions     []description    `json:"descriptions,omitempty"`
	Affected         []product        `json:"affected,omitempty"`
	ProblemTypes     []problemType    `json:"problemTypes,omitempty"`
	Impacts          []impact         `json:"impacts,omitempty"`
	Metrics          []metric         `json:"metrics,omitempty"`
	Workarounds      []description    `json:"workarounds,omitempty"`
	Solutions        []description    `json:"solutions,omitempty"`
	Exploits         []description    `json:"exploits,omitempty"`
	Configurations   []description    `json:"configurations,omitempty"`
	References       []reference      `json:"references,omitempty"`
	Timeline         timeline         `json:"timeline,omitempty"`
	Credits          credits          `json:"credits,omitempty"`
	Source           json.RawMessage  `json:"source,omitempty"`
	Tags             []string         `json:"tags,omitempty"`
	TaxonomyMappings taxonomyMappings `json:"taxonomyMappings,omitempty"`
	DateAssigned     *string          `json:"dateAssigned,omitempty"`
	DatePublic       *string          `json:"datePublic,omitempty"`
	RejectedReasons  []description    `json:"rejectedReasons,omitempty"`
	ReplacedBy       []string         `json:"replacedBy,omitempty"`
	XGenerator       interface{}      `json:"x_generator,omitempty"`
	XLegacyV4Record  interface{}      `json:"x_legacyV4Record,omitempty"`
	XRedhatCweChain  interface{}      `json:"x_redhatCweChain,omitempty"`
	XConverterErrors interface{}      `json:"x_ConverterErrors,omitempty"`
}

type adp struct {
	ProviderMetadata providerMetadata `json:"providerMetadata"`
	Title            *string          `json:"title,omitempty"`
	Descriptions     []description    `json:"descriptions,omitempty"`
	Affected         []product        `json:"affected,omitempty"`
	ProblemTypes     []problemType    `json:"problemTypes,omitempty"`
	Impacts          []impact         `json:"impacts,omitempty"`
	Metrics          []metric         `json:"metrics,omitempty"`
	Workarounds      []description    `json:"workarounds,omitempty"`
	Solutions        []description    `json:"solutions,omitempty"`
	Exploits         []description    `json:"exploits,omitempty"`
	Configurations   []description    `json:"configurations,omitempty"`
	References       []reference      `json:"references,omitempty"`
	Timeline         timeline         `json:"timeline,omitempty"`
	Credits          credits          `json:"credits,omitempty"`
	Source           json.RawMessage  `json:"source,omitempty"`
	Tags             []string         `json:"tags,omitempty"`
	TaxonomyMappings taxonomyMappings `json:"taxonomyMappings,omitempty"`
	DatePublic       *string          `json:"datePublic,omitempty"`
}

type providerMetadata struct {
	OrgID       string  `json:"orgID"`
	ShortName   *string `json:"shortName,omitempty"`
	DateUpdated *string `json:"dateUpdated,omitempty"`
}

type description struct {
	Lang            string `json:"lang"`
	Value           string `json:"value"`
	SupportingMedia []struct {
		Type   string `json:"type"`
		Base64 *bool  `json:"base64,omitempty"`
		Value  string `json:"value"`
	} `json:"supportingMedia,omitempty"`
}

type product struct {
	Vendor          *string  `json:"vendor,omitempty"`
	Product         *string  `json:"product,omitempty"`
	CollectionURL   *string  `json:"collectionURL,omitempty"`
	PackageName     *string  `json:"packageName,omitempty"`
	Cpes            []string `json:"cpes,omitempty"`
	Modules         []string `json:"modules,omitempty"`
	ProgramFiles    []string `json:"programFiles,omitempty"`
	ProgramRoutines []struct {
		Name string `json:"name"`
	} `json:"programRoutines,omitempty"`
	Platforms     []string `json:"platforms,omitempty"`
	Repo          *string  `json:"repo,omitempty"`
	DefaultStatus *string  `json:"defaultStatus,omitempty"`
	Versions      []struct {
		Status          string  `json:"status"`
		VersionType     *string `json:"versionType,omitempty"`
		Version         string  `json:"version"`
		LessThan        *string `json:"lessThan,omitempty"`
		LessThanOrEqual *string `json:"lessThanOrEqual,omitempty"`
		Changes         []struct {
			At     string `json:"at"`
			Status string `json:"status"`
		} `json:"changes,omitempty"`
	} `json:"versions,omitempty"`
}

type problemType struct {
	Descriptions []struct {
		Type        *string     `json:"type,omitempty"`
		Lang        string      `json:"lang"`
		Description string      `json:"description"`
		CweID       *string     `json:"cweId,omitempty"`
		References  []reference `json:"references,omitempty"`
	} `json:"descriptions"`
}

type impact struct {
	Descriptions []description `json:"descriptions"`
	CapecID      *string       `json:"capecId,omitempty"`
}

type metric struct {
	Format    *string `json:"format,omitempty"`
	Scenarios []struct {
		Lang  string `json:"lang"`
		Value string `json:"value"`
	} `json:"scenarios,omitempty"`
	CVSSv2  *cvssv2  `json:"cvssV2_0,omitempty"`
	CVSSv30 *cvssv30 `json:"cvssV3_0,omitempty"`
	CVSSv31 *cvssv31 `json:"cvssV3_1,omitempty"`
	CVSSv40 *cvssv40 `json:"cvssV4_0,omitempty"`
	Other   *struct {
		Type    string          `json:"type"`
		Content json.RawMessage `json:"content"`
	} `json:"other,omitempty"`
}

type cvssv2 struct {
	Version                    string   `json:"version"`
	VectorString               string   `json:"vectorString"`
	AccessVector               *string  `json:"accessVector,omitempty"`
	AccessComplexity           *string  `json:"accessComplexity,omitempty"`
	Authentication             *string  `json:"authentication,omitempty"`
	ConfidentialityImpact      *string  `json:"confidentialityImpact,omitempty"`
	IntegrityImpact            *string  `json:"integrityImpact,omitempty"`
	AvailabilityImpact         *string  `json:"availabilityImpact,omitempty"`
	BaseScore                  float64  `json:"baseScore"`
	Exploitability             *string  `json:"exploitability,omitempty"`
	RemediationLevel           *string  `json:"remediationLevel,omitempty"`
	ReportConfidence           *string  `json:"reportConfidence,omitempty"`
	TemporalScore              *float64 `json:"temporalScore,omitempty"`
	CollateralDamagePotential  *string  `json:"collateralDamagePotential,omitempty"`
	TargetDistribution         *string  `json:"targetDistribution,omitempty"`
	ConfidentialityRequirement *string  `json:"confidentialityRequirement,omitempty"`
	IntegrityRequirement       *string  `json:"integrityRequirement,omitempty"`
	AvailabilityRequirement    *string  `json:"availabilityRequirement,omitempty"`
	EnvironmentalScore         *float64 `json:"environmentalScore,omitempty"`
}

type cvssv30 struct {
	Version                       string   `json:"version"`
	VectorString                  string   `json:"vectorString"`
	AttackVector                  *string  `json:"attackVector,omitempty"`
	AttackComplexity              *string  `json:"attackComplexity,omitempty"`
	PrivilegesRequired            *string  `json:"privilegesRequired,omitempty"`
	UserInteraction               *string  `json:"userInteraction,omitempty"`
	Scope                         *string  `json:"scope,omitempty"`
	ConfidentialityImpact         *string  `json:"confidentialityImpact,omitempty"`
	IntegrityImpact               *string  `json:"integrityImpact,omitempty"`
	AvailabilityImpact            *string  `json:"availabilityImpact,omitempty"`
	BaseScore                     float64  `json:"baseScore"`
	BaseSeverity                  string   `json:"baseSeverity"`
	ExploitCodeMaturity           *string  `json:"exploitCodeMaturity,omitempty"`
	RemediationLevel              *string  `json:"remediationLevel,omitempty"`
	ReportConfidence              *string  `json:"reportConfidence,omitempty"`
	TemporalScore                 *float64 `json:"temporalScore,omitempty"`
	TemporalSeverity              *string  `json:"temporalSeverity,omitempty"`
	ConfidentialityRequirement    *string  `json:"confidentialityRequirement,omitempty"`
	IntegrityRequirement          *string  `json:"integrityRequirement,omitempty"`
	AvailabilityRequirement       *string  `json:"availabilityRequirement,omitempty"`
	ModifiedAttackVector          *string  `json:"modifiedAttackVector,omitempty"`
	ModifiedAttackComplexity      *string  `json:"modifiedAttackComplexity,omitempty"`
	ModifiedPrivilegesRequired    *string  `json:"modifiedPrivilegesRequired,omitempty"`
	ModifiedUserInteraction       *string  `json:"modifiedUserInteraction,omitempty"`
	ModifiedScope                 *string  `json:"modifiedScope,omitempty"`
	ModifiedConfidentialityImpact *string  `json:"modifiedConfidentialityImpact,omitempty"`
	ModifiedIntegrityImpact       *string  `json:"modifiedIntegrityImpact,omitempty"`
	ModifiedAvailabilityImpact    *string  `json:"modifiedAvailabilityImpact,omitempty"`
	EnvironmentalScore            *float64 `json:"environmentalScore,omitempty"`
	EnvironmentalSeverity         *string  `json:"environmentalSeverity,omitempty"`
}

type cvssv31 struct {
	Version                       string   `json:"version"`
	VectorString                  string   `json:"vectorString"`
	AttackVector                  *string  `json:"attackVector,omitempty"`
	AttackComplexity              *string  `json:"attackComplexity,omitempty"`
	PrivilegesRequired            *string  `json:"privilegesRequired,omitempty"`
	UserInteraction               *string  `json:"userInteraction,omitempty"`
	Scope                         *string  `json:"scope,omitempty"`
	ConfidentialityImpact         *string  `json:"confidentialityImpact,omitempty"`
	IntegrityImpact               *string  `json:"integrityImpact,omitempty"`
	AvailabilityImpact            *string  `json:"availabilityImpact,omitempty"`
	BaseScore                     float64  `json:"baseScore"`
	BaseSeverity                  string   `json:"baseSeverity"`
	ExploitCodeMaturity           *string  `json:"exploitCodeMaturity,omitempty"`
	RemediationLevel              *string  `json:"remediationLevel,omitempty"`
	ReportConfidence              *string  `json:"reportConfidence,omitempty"`
	TemporalScore                 *float64 `json:"temporalScore,omitempty"`
	TemporalSeverity              *string  `json:"temporalSeverity,omitempty"`
	ConfidentialityRequirement    *string  `json:"confidentialityRequirement,omitempty"`
	IntegrityRequirement          *string  `json:"integrityRequirement,omitempty"`
	AvailabilityRequirement       *string  `json:"availabilityRequirement,omitempty"`
	ModifiedAttackVector          *string  `json:"modifiedAttackVector,omitempty"`
	ModifiedAttackComplexity      *string  `json:"modifiedAttackComplexity,omitempty"`
	ModifiedPrivilegesRequired    *string  `json:"modifiedPrivilegesRequired,omitempty"`
	ModifiedUserInteraction       *string  `json:"modifiedUserInteraction,omitempty"`
	ModifiedScope                 *string  `json:"modifiedScope,omitempty"`
	ModifiedConfidentialityImpact *string  `json:"modifiedConfidentialityImpact,omitempty"`
	ModifiedIntegrityImpact       *string  `json:"modifiedIntegrityImpact,omitempty"`
	ModifiedAvailabilityImpact    *string  `json:"modifiedAvailabilityImpact,omitempty"`
	EnvironmentalScore            *float64 `json:"environmentalScore,omitempty"`
	EnvironmentalSeverity         *string  `json:"environmentalSeverity,omitempty"`
}

type cvssv40 struct {
	Version                           string   `json:"version"`
	VectorString                      string   `json:"vectorString"`
	BaseScore                         float64  `json:"baseScore"`
	BaseSeverity                      string   `json:"baseSeverity"`
	AttackVector                      *string  `json:"attackVector,omitempty"`
	AttackComplexity                  *string  `json:"attackComplexity,omitempty"`
	AttackRequirements                *string  `json:"attackRequirements,omitempty"`
	PrivilegesRequired                *string  `json:"privilegesRequired,omitempty"`
	UserInteraction                   *string  `json:"userInteraction,omitempty"`
	VulnConfidentialityImpact         *string  `json:"vulnConfidentialityImpact,omitempty"`
	VulnIntegrityImpact               *string  `json:"vulnIntegrityImpact,omitempty"`
	VulnAvailabilityImpact            *string  `json:"vulnAvailabilityImpact,omitempty"`
	SubConfidentialityImpact          *string  `json:"subConfidentialityImpact,omitempty"`
	SubIntegrityImpact                *string  `json:"subIntegrityImpact,omitempty"`
	SubAvailabilityImpact             *string  `json:"subAvailabilityImpact,omitempty"`
	ExploitMaturity                   *string  `json:"exploitMaturity,omitempty"`
	ConfidentialityRequirement        *string  `json:"confidentialityRequirement,omitempty"`
	IntegrityRequirement              *string  `json:"integrityRequirement,omitempty"`
	AvailabilityRequirement           *string  `json:"availabilityRequirement,omitempty"`
	ModifiedAttackVector              *string  `json:"modifiedAttackVector,omitempty"`
	ModifiedAttackComplexity          *string  `json:"modifiedAttackComplexity,omitempty"`
	ModifiedAttackRequirements        *string  `json:"modifiedAttackRequirements,omitempty"`
	ModifiedPrivilegesRequired        *string  `json:"modifiedPrivilegesRequired,omitempty"`
	ModifiedUserInteraction           *string  `json:"modifiedUserInteraction,omitempty"`
	ModifiedVulnConfidentialityImpact *string  `json:"modifiedVulnConfidentialityImpact,omitempty"`
	ModifiedVulnIntegrityImpact       *string  `json:"modifiedVulnIntegrityImpact,omitempty"`
	ModifiedVulnAvailabilityImpact    *string  `json:"modifiedVulnAvailabilityImpact,omitempty"`
	ModifiedSubConfidentialityImpact  *string  `json:"modifiedSubConfidentialityImpact,omitempty"`
	ModifiedSubIntegrityImpact        *string  `json:"modifiedSubIntegrityImpact,omitempty"`
	ModifiedSubAvailabilityImpact     *string  `json:"modifiedSubAvailabilityImpact,omitempty"`
	Safety                            *string  `json:"Safety,omitempty"`
	Automatable                       *string  `json:"Automatable,omitempty"`
	Recovery                          *string  `json:"Recovery,omitempty"`
	ValueDensity                      *string  `json:"valueDensity,omitempty"`
	VulnerabilityResponseEffort       *string  `json:"vulnerabilityResponseEffort,omitempty"`
	ProviderUrgency                   *string  `json:"providerUrgency,omitempty"`
	ThreatScore                       *float64 `json:"threatScore,omitempty"`
	ThreatSeverity                    *string  `json:"threatSeverity,omitempty"`
	EnvironmentalScore                *float64 `json:"environmentalScore,omitempty"`
	EnvironmentalSeverity             *string  `json:"environmentalSeverity,omitempty"`
}

type ssvc struct {
	ID        string `json:"id,omitempty"`
	Role      string `json:"role,omitempty"`
	Version   string `json:"version,omitempty"`
	Timestamp string `json:"timestamp,omitempty"`
	Options   []struct {
		Exploitation    *string `json:"Exploitation,omitempty"`
		Automatable     *string `json:"Automatable,omitempty"`
		TechnicalImpact *string `json:"Technical Impact,omitempty"`
	} `json:"options,omitempty"`
}

type kev struct {
	DateAdded string `json:"date_added"`
	Reference string `json:"reference"`
}

type reference struct {
	Name *string  `json:"name,omitempty"`
	Tags []string `json:"tags,omitempty"`
	URL  string   `json:"url"`
}

type timeline []struct {
	Time  string `json:"time"`
	Lang  string `json:"lang"`
	Value string `json:"value"`
}

type credits []struct {
	Type  *string `json:"type,omitempty"`
	Lang  string  `json:"lang"`
	User  *string `json:"user,omitempty"`
	Value string  `json:"value"`
}

type taxonomyMappings []struct {
	TaxonomyVersion   *string `json:"taxonomyVersion,omitempty"`
	TaxonomyName      string  `json:"taxonomyName"`
	TaxonomyRelations []struct {
		TaxonomyID        string `json:"taxonomyId"`
		RelationshipName  string `json:"relationshipName"`
		RelationshipValue string `json:"relationshipValue"`
	} `json:"taxonomyRelations"`
}
